# SmartAuth Diagram Pack

This folder contains version-controlled architecture/authentication diagrams generated from the current repository structure and code.

## Contents

- `mermaid/`
  - `01-architecture.md` – high-level system architecture (Aspire + projects + Postgres/pgvector).
  - `02-auth-flow.md` – register/login/2FA decision flow.
  - `03-auth-sequence.md` – runtime login + temporary token + 2FA verify sequence.
- `plantuml/`
  - `01-component.puml` – project/component dependency view.
  - `02-sequence-login-2fa.puml` – login and optional 2FA sequence.
  - `03-class-domain.puml` – key domain/infrastructure model classes and relationships.
  - `04-deployment.puml` – Aspire-based deployment/runtime topology.
  - `05-activity-login.puml` – login activity with 2FA branch.
- `out/`
  - `svg/` and `png/` outputs generated by render scripts.

## How to view Mermaid files

- Open Markdown files directly in GitHub/GitLab or VS Code with Mermaid preview support.
- Each Mermaid file contains one fenced block:

```markdown
```mermaid
...
```
```

## How to render PlantUML to SVG/PNG

From repo root:

- Bash (Linux/macOS):
  - `bash scripts/render-diagrams.sh`
- PowerShell (Windows):
  - `pwsh ./scripts/render-diagrams.ps1`

Both scripts:
- Require Docker.
- Render all `docs/diagrams/plantuml/*.puml` into:
  - `docs/diagrams/out/svg`
  - `docs/diagrams/out/png`

If Docker is not installed/running, scripts print a helpful message and exit with non-zero status.

## Notes

- Diagrams are based on current code paths in:
  - `SmartAuth.AppHost`, `SmartAuth.Api`, `SmartAuth.Web`, `SmartAuth.Web/ClientApp`, `SmartAuth.Infrastructure`, `SmartAuth.Domain`, `SmartAuth.ServiceDefaults`, `SmartAuth.Tests`.
- Only currently implemented features are shown as active runtime flows.
- If future/planned flows are later added, mark them as **planned** in diagram labels.
